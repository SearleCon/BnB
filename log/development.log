

Started GET "/bnbs/fish-eagle-villa/photos" for 127.0.0.1 at 2013-07-26 19:22:58 +0200
Processing by PhotosController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.3ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "photos" WHERE "photos"."bnb_id" = 1 AND "photos"."processed" = 't'[0m
  [1m[35mPhoto Load (0.2ms)[0m  SELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" = 1 AND "photos"."processed" = 't'
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" IN (1)[0m
  Rendered photos/_photo.html.erb (4.6ms)
  Rendered photos/index.html.erb within layouts/application (175.1ms)
Compiled photos.js  (208ms)  (pid 5334)
  Rendered layouts/_shim.html.erb (0.1ms)
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (1.4ms)
  Rendered layouts/_header.html.erb (88.3ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (1.0ms)
Completed 200 OK in 530ms (Views: 514.7ms | ActiveRecord: 1.9ms)


Started DELETE "/photos/98" for 127.0.0.1 at 2013-07-26 19:23:21 +0200
Processing by PhotosController#destroy as HTML
  Parameters: {"authenticity_token"=>"3e3WSRadWc/zgvjFqair2+WuSKNCgsiurXj4p02dnNg=", "id"=>"98"}
  [1m[36mPhoto Load (0.3ms)[0m  [1mSELECT "photos".* FROM "photos" WHERE "photos"."id" = ? LIMIT 1[0m  [["id", "98"]]
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "bnbs" SET "photos_count" = COALESCE("photos_count", 0) - 1 WHERE "bnbs"."id" = 1[0m
  [1m[35mSQL (0.1ms)[0m  DELETE FROM "photos" WHERE "photos"."id" = ?  [["id", 98]]
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "bnbs" SET "updated_at" = '2013-07-26 17:23:22.076960' WHERE "bnbs"."id" = 1[0m
  [1m[35m (1.5ms)[0m  commit transaction
Redirected to http://localhost:3000/bnbs/fish-eagle-villa/photos
Completed 302 Found in 8084ms (ActiveRecord: 0.0ms)


Started GET "/bnbs/fish-eagle-villa/photos" for 127.0.0.1 at 2013-07-26 19:23:30 +0200
Processing by PhotosController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "photos" WHERE "photos"."bnb_id" = 1 AND "photos"."processed" = 't'[0m
  [1m[35mPhoto Load (0.1ms)[0m  SELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" = 1 AND "photos"."processed" = 't'
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" IN (1)[0m
  Rendered photos/_photo.html.erb (3.9ms)
  Rendered photos/index.html.erb within layouts/application (15.4ms)
  Rendered layouts/_shim.html.erb (0.1ms)
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (1.5ms)
  Rendered layouts/_header.html.erb (8.8ms)
  Rendered shared/_flash_messages.html.erb (0.2ms)
  Rendered layouts/_footer.html.erb (1.1ms)
Completed 200 OK in 61ms (Views: 48.3ms | ActiveRecord: 1.4ms)
Connecting to database specified by database.yml


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:26:28 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  Rendered bookings/index.html.erb within layouts/application (28.9ms)
Compiled bookings.js  (246ms)  (pid 5658)
  Rendered layouts/_shim.html.erb (0.6ms)
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  Rendered layouts/_owner_menu_items.html.erb (3.1ms)
  Rendered layouts/_header.html.erb (13.9ms)
  Rendered shared/_flash_messages.html.erb (0.7ms)
  Rendered layouts/_footer.html.erb (1.9ms)
Completed 200 OK in 727ms (Views: 411.1ms | ActiveRecord: 2.2ms)


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:26:41 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  Rendered bookings/index.html.erb within layouts/application (20.0ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  Rendered layouts/_owner_menu_items.html.erb (2.6ms)
  Rendered layouts/_header.html.erb (11.0ms)
  Rendered shared/_flash_messages.html.erb (0.6ms)
  Rendered layouts/_footer.html.erb (1.8ms)
Completed 200 OK in 383ms (Views: 69.5ms | ActiveRecord: 2.3ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374859615019" for 127.0.0.1 at 2013-07-26 19:26:55 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374859615019"}
  [1m[35mUser Load (0.3ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  SELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)
Completed 200 OK in 231ms (Views: 96.9ms | ActiveRecord: 1.5ms)


Started GET "/events?start=1374962400&end=1378591200&_=1374859615020" for 127.0.0.1 at 2013-07-26 19:27:11 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1374962400", "end"=>"1378591200", "_"=>"1374859615020"}
  [1m[35mUser Load (0.3ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)
Completed 200 OK in 189ms (Views: 150.0ms | ActiveRecord: 1.1ms)


Started GET "/bnbs/fish-eagle-villa/bookings/new?date=Tue%20Aug%2006%202013%2000:00:00%20GMT+0200%20(SAST)" for 127.0.0.1 at 2013-07-26 19:27:13 +0200
Processing by BookingsController#new as HTML
  Parameters: {"date"=>"Tue Aug 06 2013 00:00:00 GMT 0200 (SAST)", "bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.1ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  Rendered shared/_error_messages.html.erb (0.7ms)
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1[0m
  [1m[35mRate Load (0.1ms)[0m  SELECT "rates".* FROM "rates" WHERE "rates"."rateable_id" = 1 AND "rates"."rateable_type" = 'Bnb'
  [1m[36mGuest Load (0.2ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."bnb_id" = 1[0m
  Rendered bookings/_guest_fields.html.erb (76.3ms)
  Rendered bookings/new.html.erb within layouts/application (134.8ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (2.4ms)
  Rendered layouts/_header.html.erb (11.1ms)
  Rendered shared/_flash_messages.html.erb (0.6ms)
  Rendered layouts/_footer.html.erb (1.8ms)
Completed 200 OK in 534ms (Views: 181.5ms | ActiveRecord: 3.8ms)


Started GET "/bnbs/fish-eagle-villa/rooms/find_available?start_at=Tue+Aug+06+2013+00%3A00%3A00+GMT%2B0200+(SAST)&end_at=Wed+Aug+07+2013+00%3A00%3A00+GMT%2B0200+(SAST)&_=1374859634501" for 127.0.0.1 at 2013-07-26 19:27:20 +0200
Processing by RoomsController#find_available as JS
  Parameters: {"start_at"=>"Tue Aug 06 2013 00:00:00 GMT+0200 (SAST)", "end_at"=>"Wed Aug 07 2013 00:00:00 GMT+0200 (SAST)", "_"=>"1374859634501", "bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT "bookings"."id" AS t0_r0, "bookings"."guest_id" AS t0_r1, "bookings"."active" AS t0_r2, "bookings"."created_at" AS t0_r3, "bookings"."updated_at" AS t0_r4, "bookings"."status" AS t0_r5, "bookings"."bnb_id" AS t0_r6, "bookings"."user_id" AS t0_r7, "bookings"."online" AS t0_r8, "bookings"."rate_id" AS t0_r9, "events"."id" AS t1_r0, "events"."name" AS t1_r1, "events"."start_at" AS t1_r2, "events"."end_at" AS t1_r3, "events"."created_at" AS t1_r4, "events"."updated_at" AS t1_r5, "events"."booking_id" AS t1_r6, "events"."color" AS t1_r7, "rooms"."id" AS t2_r0, "rooms"."description" AS t2_r1, "rooms"."en_suite" AS t2_r2, "rooms"."rates" AS t2_r3, "rooms"."extras" AS t2_r4, "rooms"."created_at" AS t2_r5, "rooms"."updated_at" AS t2_r6, "rooms"."bnb_id" AS t2_r7, "rooms"."room_number" AS t2_r8, "rooms"."available" AS t2_r9, "rooms"."capacity" AS t2_r10 FROM "bookings" LEFT OUTER JOIN "events" ON "events"."booking_id" = "bookings"."id" LEFT OUTER JOIN "bookings_rooms" ON "bookings_rooms"."booking_id" = "bookings"."id" LEFT OUTER JOIN "rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings"."active" = 't' AND (events.start_at <= '2013-08-07' AND events.end_at >= '2013-08-06')
  [1m[36mRoom Load (0.3ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1 AND (id NOT IN (select id from rooms where id in (NULL)))[0m
  Rendered bookings/_unbooked_rooms.html.erb (7.0ms)
  Rendered rooms/find_available.js.erb (12.2ms)
Completed 200 OK in 70ms (Views: 19.4ms | ActiveRecord: 1.8ms)


Started POST "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:27:26 +0200
Processing by BookingsController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"3e3WSRadWc/zgvjFqair2+WuSKNCgsiurXj4p02dnNg=", "booking"=>{"event_attributes"=>{"start_at"=>"Tue Aug 06 2013 00:00:00 GMT 0200 (SAST)", "end_at"=>"2013-08-07 02:00:00 +0200"}, "rate_id"=>"18", "guest_id"=>"78", "room_ids"=>["17", ""]}, "commit"=>"Create Booking", "bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mRoom Load (4.3ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."id" = ? LIMIT 1[0m  [["id", 17]]
  [1m[35mGuest Load (0.2ms)[0m  SELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35mRate Load (0.2ms)[0m  SELECT "rates".* FROM "rates" WHERE "rates"."id" = 18 LIMIT 1
  [1m[36mSQL (1.5ms)[0m  [1mINSERT INTO "bookings" ("active", "bnb_id", "created_at", "guest_id", "online", "rate_id", "status", "updated_at", "user_id") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["active", true], ["bnb_id", 1], ["created_at", Fri, 26 Jul 2013 19:27:26 SAST +02:00], ["guest_id", 78], ["online", false], ["rate_id", 18], ["status", "booked"], ["updated_at", Fri, 26 Jul 2013 19:27:26 SAST +02:00], ["user_id", 1]]
  [1m[35m (0.2ms)[0m  INSERT INTO "bookings_rooms" ("booking_id", "room_id") VALUES (86, 17)
  [1m[36mSQL (1.9ms)[0m  [1mINSERT INTO "events" ("booking_id", "color", "created_at", "end_at", "name", "start_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["booking_id", 86], ["color", "blue"], ["created_at", Fri, 26 Jul 2013 19:27:26 SAST +02:00], ["end_at", Wed, 07 Aug 2013 02:00:00 SAST +02:00], ["name", "James (0435567979 tim@bob.com)"], ["start_at", Tue, 06 Aug 2013 02:00:00 SAST +02:00], ["updated_at", Fri, 26 Jul 2013 19:27:26 SAST +02:00]]
  [1m[35mBooking Load (0.1ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = 86 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "bookings" SET "updated_at" = '2013-07-26 17:27:26.749372' WHERE "bookings"."id" = 86[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  [1m[36m (1.2ms)[0m  [1mcommit transaction[0m
Redirected to http://localhost:3000/bnbs/fish-eagle-villa/bookings
Completed 302 Found in 263ms (ActiveRecord: 0.0ms)


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:27:26 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered bookings/index.html.erb within layouts/application (90.1ms)
  Rendered layouts/_shim.html.erb (0.1ms)
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (1.3ms)
  Rendered layouts/_header.html.erb (7.9ms)
  Rendered shared/_flash_messages.html.erb (0.2ms)
  Rendered layouts/_footer.html.erb (1.0ms)
Completed 200 OK in 137ms (Views: 123.4ms | ActiveRecord: 0.6ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374859647074" for 127.0.0.1 at 2013-07-26 19:27:27 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374859647074"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)[0m
Completed 200 OK in 35ms (Views: 25.5ms | ActiveRecord: 0.6ms)


Started GET "/bookings/86?_=1374859647075" for 127.0.0.1 at 2013-07-26 19:29:29 +0200
Processing by BookingsController#show as JS
  Parameters: {"_"=>"1374859647075", "id"=>"86"}
  [1m[35mBooking Load (0.2ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mGuest Load (0.1ms)[0m  SELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1
  [1m[36mEvent Load (0.1ms)[0m  [1mSELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  Rendered bookings/_show.html.erb (118.5ms)
  Rendered bookings/show.js.erb (123.4ms)
Completed 200 OK in 317ms (Views: 132.3ms | ActiveRecord: 3.3ms)


Started GET "/bookings/86/edit" for 127.0.0.1 at 2013-07-26 19:29:32 +0200
Processing by BookingsController#edit as HTML
  Parameters: {"id"=>"86"}
  [1m[36mBooking Load (0.2ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  Rendered shared/_error_messages.html.erb (1.2ms)
  [1m[36mEvent Load (0.3ms)[0m  [1mSELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1[0m
  [1m[35mBnb Load (0.4ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  [1m[36mRate Load (0.1ms)[0m  [1mSELECT "rates".* FROM "rates" WHERE "rates"."rateable_id" = 1 AND "rates"."rateable_type" = 'Bnb'[0m
  [1m[35mGuest Load (0.2ms)[0m  SELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  Rendered bookings/edit.html.erb within layouts/application (195.0ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (2.3ms)
  Rendered layouts/_header.html.erb (10.1ms)
  Rendered shared/_flash_messages.html.erb (0.7ms)
  Rendered layouts/_footer.html.erb (1.6ms)
Completed 200 OK in 249ms (Views: 233.0ms | ActiveRecord: 2.8ms)


Started GET "/bnbs/fish-eagle-villa/rooms/find_available?booking_id=86&start_at=Tue+Aug+06+2013+00%3A00%3A00+GMT%2B0200+(SAST)&end_at=Wed+Aug+07+2013+00%3A00%3A00+GMT%2B0200+(SAST)&_=1374859647076" for 127.0.0.1 at 2013-07-26 19:29:35 +0200
Processing by RoomsController#find_available as JS
  Parameters: {"booking_id"=>"86", "start_at"=>"Tue Aug 06 2013 00:00:00 GMT+0200 (SAST)", "end_at"=>"Wed Aug 07 2013 00:00:00 GMT+0200 (SAST)", "_"=>"1374859647076", "bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mRoom Load (0.1ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1
  [1m[36mBooking Load (0.4ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mSQL (0.3ms)[0m  SELECT "bookings"."id" AS t0_r0, "bookings"."guest_id" AS t0_r1, "bookings"."active" AS t0_r2, "bookings"."created_at" AS t0_r3, "bookings"."updated_at" AS t0_r4, "bookings"."status" AS t0_r5, "bookings"."bnb_id" AS t0_r6, "bookings"."user_id" AS t0_r7, "bookings"."online" AS t0_r8, "bookings"."rate_id" AS t0_r9, "events"."id" AS t1_r0, "events"."name" AS t1_r1, "events"."start_at" AS t1_r2, "events"."end_at" AS t1_r3, "events"."created_at" AS t1_r4, "events"."updated_at" AS t1_r5, "events"."booking_id" AS t1_r6, "events"."color" AS t1_r7, "rooms"."id" AS t2_r0, "rooms"."description" AS t2_r1, "rooms"."en_suite" AS t2_r2, "rooms"."rates" AS t2_r3, "rooms"."extras" AS t2_r4, "rooms"."created_at" AS t2_r5, "rooms"."updated_at" AS t2_r6, "rooms"."bnb_id" AS t2_r7, "rooms"."room_number" AS t2_r8, "rooms"."available" AS t2_r9, "rooms"."capacity" AS t2_r10 FROM "bookings" LEFT OUTER JOIN "events" ON "events"."booking_id" = "bookings"."id" LEFT OUTER JOIN "bookings_rooms" ON "bookings_rooms"."booking_id" = "bookings"."id" LEFT OUTER JOIN "rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings"."active" = 't' AND (events.start_at <= '2013-08-07' AND events.end_at >= '2013-08-06')
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  [1m[35mRoom Load (0.3ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86 AND "rooms"."bnb_id" = 1 AND (id NOT IN (select id from rooms where id in (17)))
  Rendered bookings/_unbooked_rooms.html.erb (8.7ms)
  Rendered rooms/find_available.js.erb (12.5ms)
Completed 200 OK in 343ms (Views: 17.9ms | ActiveRecord: 4.6ms)


Started GET "/bnbs/fish-eagle-villa/rooms/find_available?booking_id=86&start_at=Tue+Aug+06+2013+00%3A00%3A00+GMT%2B0200+(SAST)&end_at=Wed+Aug+07+2013+00%3A00%3A00+GMT%2B0200+(SAST)&_=1374859647077" for 127.0.0.1 at 2013-07-26 19:29:38 +0200
Processing by RoomsController#find_available as JS
  Parameters: {"booking_id"=>"86", "start_at"=>"Tue Aug 06 2013 00:00:00 GMT+0200 (SAST)", "end_at"=>"Wed Aug 07 2013 00:00:00 GMT+0200 (SAST)", "_"=>"1374859647077", "bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mRoom Load (0.1ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1[0m
  [1m[35mBooking Load (0.2ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "bookings"."id" AS t0_r0, "bookings"."guest_id" AS t0_r1, "bookings"."active" AS t0_r2, "bookings"."created_at" AS t0_r3, "bookings"."updated_at" AS t0_r4, "bookings"."status" AS t0_r5, "bookings"."bnb_id" AS t0_r6, "bookings"."user_id" AS t0_r7, "bookings"."online" AS t0_r8, "bookings"."rate_id" AS t0_r9, "events"."id" AS t1_r0, "events"."name" AS t1_r1, "events"."start_at" AS t1_r2, "events"."end_at" AS t1_r3, "events"."created_at" AS t1_r4, "events"."updated_at" AS t1_r5, "events"."booking_id" AS t1_r6, "events"."color" AS t1_r7, "rooms"."id" AS t2_r0, "rooms"."description" AS t2_r1, "rooms"."en_suite" AS t2_r2, "rooms"."rates" AS t2_r3, "rooms"."extras" AS t2_r4, "rooms"."created_at" AS t2_r5, "rooms"."updated_at" AS t2_r6, "rooms"."bnb_id" AS t2_r7, "rooms"."room_number" AS t2_r8, "rooms"."available" AS t2_r9, "rooms"."capacity" AS t2_r10 FROM "bookings" LEFT OUTER JOIN "events" ON "events"."booking_id" = "bookings"."id" LEFT OUTER JOIN "bookings_rooms" ON "bookings_rooms"."booking_id" = "bookings"."id" LEFT OUTER JOIN "rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings"."active" = 't' AND (events.start_at <= '2013-08-07' AND events.end_at >= '2013-08-06')[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  [1m[36mRoom Load (0.3ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86 AND "rooms"."bnb_id" = 1 AND (id NOT IN (select id from rooms where id in (17)))[0m
  Rendered bookings/_unbooked_rooms.html.erb (7.8ms)
  Rendered rooms/find_available.js.erb (11.7ms)
Completed 200 OK in 346ms (Views: 17.1ms | ActiveRecord: 4.1ms)


Started GET "/bnbs/fish-eagle-villa/rooms/find_available?booking_id=86&start_at=Tue+Aug+06+2013+00%3A00%3A00+GMT%2B0200+(SAST)&end_at=Wed+Aug+07+2013+00%3A00%3A00+GMT%2B0200+(SAST)&_=1374859647078" for 127.0.0.1 at 2013-07-26 19:30:02 +0200
Processing by RoomsController#find_available as JS
  Parameters: {"booking_id"=>"86", "start_at"=>"Tue Aug 06 2013 00:00:00 GMT+0200 (SAST)", "end_at"=>"Wed Aug 07 2013 00:00:00 GMT+0200 (SAST)", "_"=>"1374859647078", "bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1[0m
  [1m[35mBooking Load (0.2ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "bookings"."id" AS t0_r0, "bookings"."guest_id" AS t0_r1, "bookings"."active" AS t0_r2, "bookings"."created_at" AS t0_r3, "bookings"."updated_at" AS t0_r4, "bookings"."status" AS t0_r5, "bookings"."bnb_id" AS t0_r6, "bookings"."user_id" AS t0_r7, "bookings"."online" AS t0_r8, "bookings"."rate_id" AS t0_r9, "events"."id" AS t1_r0, "events"."name" AS t1_r1, "events"."start_at" AS t1_r2, "events"."end_at" AS t1_r3, "events"."created_at" AS t1_r4, "events"."updated_at" AS t1_r5, "events"."booking_id" AS t1_r6, "events"."color" AS t1_r7, "rooms"."id" AS t2_r0, "rooms"."description" AS t2_r1, "rooms"."en_suite" AS t2_r2, "rooms"."rates" AS t2_r3, "rooms"."extras" AS t2_r4, "rooms"."created_at" AS t2_r5, "rooms"."updated_at" AS t2_r6, "rooms"."bnb_id" AS t2_r7, "rooms"."room_number" AS t2_r8, "rooms"."available" AS t2_r9, "rooms"."capacity" AS t2_r10 FROM "bookings" LEFT OUTER JOIN "events" ON "events"."booking_id" = "bookings"."id" LEFT OUTER JOIN "bookings_rooms" ON "bookings_rooms"."booking_id" = "bookings"."id" LEFT OUTER JOIN "rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings"."active" = 't' AND (events.start_at <= '2013-08-07' AND events.end_at >= '2013-08-06')[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1 AND (id NOT IN (select id from rooms where id in (17)))[0m
  Rendered bookings/_unbooked_rooms.html.erb (4.6ms)
  Rendered rooms/find_available.js.erb (8.2ms)
Completed 200 OK in 346ms (Views: 14.1ms | ActiveRecord: 4.3ms)


Started GET "/bookings/86/edit" for 127.0.0.1 at 2013-07-26 19:31:14 +0200
Processing by BookingsController#edit as HTML
  Parameters: {"id"=>"86"}
  [1m[35mBooking Load (0.2ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered shared/_error_messages.html.erb (0.1ms)
  [1m[35mEvent Load (0.1ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1[0m
  [1m[35mRate Load (0.2ms)[0m  SELECT "rates".* FROM "rates" WHERE "rates"."rateable_id" = 1 AND "rates"."rateable_type" = 'Bnb'
  [1m[36mGuest Load (0.2ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  Rendered bookings/edit.html.erb within layouts/application (296.3ms)
  Rendered layouts/_shim.html.erb (0.0ms)
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  Rendered layouts/_owner_menu_items.html.erb (1.3ms)
  Rendered layouts/_header.html.erb (7.9ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (1.0ms)
Completed 200 OK in 538ms (Views: 324.5ms | ActiveRecord: 5.1ms)


Started GET "/bnbs/fish-eagle-villa/rooms/find_available?booking_id=86&start_at=Tue+Aug+06+2013+00%3A00%3A00+GMT%2B0200+(SAST)&end_at=Wed+Aug+07+2013+00%3A00%3A00+GMT%2B0200+(SAST)&_=1374859875707" for 127.0.0.1 at 2013-07-26 19:31:17 +0200
Processing by RoomsController#find_available as JS
  Parameters: {"booking_id"=>"86", "start_at"=>"Tue Aug 06 2013 00:00:00 GMT+0200 (SAST)", "end_at"=>"Wed Aug 07 2013 00:00:00 GMT+0200 (SAST)", "_"=>"1374859875707", "bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1
  [1m[36mBooking Load (0.2ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mSQL (0.3ms)[0m  SELECT "bookings"."id" AS t0_r0, "bookings"."guest_id" AS t0_r1, "bookings"."active" AS t0_r2, "bookings"."created_at" AS t0_r3, "bookings"."updated_at" AS t0_r4, "bookings"."status" AS t0_r5, "bookings"."bnb_id" AS t0_r6, "bookings"."user_id" AS t0_r7, "bookings"."online" AS t0_r8, "bookings"."rate_id" AS t0_r9, "events"."id" AS t1_r0, "events"."name" AS t1_r1, "events"."start_at" AS t1_r2, "events"."end_at" AS t1_r3, "events"."created_at" AS t1_r4, "events"."updated_at" AS t1_r5, "events"."booking_id" AS t1_r6, "events"."color" AS t1_r7, "rooms"."id" AS t2_r0, "rooms"."description" AS t2_r1, "rooms"."en_suite" AS t2_r2, "rooms"."rates" AS t2_r3, "rooms"."extras" AS t2_r4, "rooms"."created_at" AS t2_r5, "rooms"."updated_at" AS t2_r6, "rooms"."bnb_id" AS t2_r7, "rooms"."room_number" AS t2_r8, "rooms"."available" AS t2_r9, "rooms"."capacity" AS t2_r10 FROM "bookings" LEFT OUTER JOIN "events" ON "events"."booking_id" = "bookings"."id" LEFT OUTER JOIN "bookings_rooms" ON "bookings_rooms"."booking_id" = "bookings"."id" LEFT OUTER JOIN "rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings"."active" = 't' AND (events.start_at <= '2013-08-07' AND events.end_at >= '2013-08-06')
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35mRoom Load (0.3ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1 AND (id NOT IN (select id from rooms where id in (17)))
  [1m[36m (0.3ms)[0m  [1mINSERT INTO "bookings_rooms" ("booking_id", "room_id") VALUES (86, 18)[0m
  [1m[35m (2.3ms)[0m  commit transaction
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  Rendered bookings/_unbooked_rooms.html.erb (9.9ms)
  Rendered rooms/find_available.js.erb (13.7ms)
Completed 500 Internal Server Error in 358ms

ActionView::Template::Error (undefined method `room_info' for #<ActiveRecord::Relation:0x007fcc6af0bae8>):
    1: <%= simple_fields_for @booking do |f| %>
    2:   <%= f.association :rooms, label_method: :room_info , collection: @unbooked, as: :check_boxes%>
    3: <% end %>
  app/views/bookings/_unbooked_rooms.html.erb:2:in `block in _app_views_bookings__unbooked_rooms_html_erb__511354741726604294_70257972170180'
  app/views/bookings/_unbooked_rooms.html.erb:1:in `_app_views_bookings__unbooked_rooms_html_erb__511354741726604294_70257972170180'
  app/views/rooms/find_available.js.erb:1:in `_app_views_rooms_find_available_js_erb___1344595755178794656_70257972104960'
  app/controllers/rooms_controller.rb:39:in `find_available'


  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/actionpack-3.2.14/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.7ms)
  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/actionpack-3.2.14/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (1.3ms)
  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/actionpack-3.2.14/lib/action_dispatch/middleware/templates/rescues/template_error.erb within rescues/layout (26.6ms)


Started GET "/bookings/86/edit" for 127.0.0.1 at 2013-07-26 19:32:16 +0200
Processing by BookingsController#edit as HTML
  Parameters: {"id"=>"86"}
  [1m[35mBooking Load (0.2ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered shared/_error_messages.html.erb (0.6ms)
  [1m[35mEvent Load (0.2ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1[0m
  [1m[35mRate Load (0.1ms)[0m  SELECT "rates".* FROM "rates" WHERE "rates"."rateable_id" = 1 AND "rates"."rateable_type" = 'Bnb'
  [1m[36mGuest Load (0.2ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  Rendered bookings/edit.html.erb within layouts/application (197.8ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  Rendered layouts/_owner_menu_items.html.erb (2.1ms)
  Rendered layouts/_header.html.erb (10.1ms)
  Rendered shared/_flash_messages.html.erb (0.7ms)
  Rendered layouts/_footer.html.erb (1.6ms)
Completed 200 OK in 429ms (Views: 230.5ms | ActiveRecord: 4.6ms)


Started GET "/bnbs/fish-eagle-villa/rooms/find_available?booking_id=86&start_at=Tue+Aug+06+2013+00%3A00%3A00+GMT%2B0200+(SAST)&end_at=Wed+Aug+07+2013+00%3A00%3A00+GMT%2B0200+(SAST)&_=1374859937153" for 127.0.0.1 at 2013-07-26 19:32:19 +0200
Processing by RoomsController#find_available as JS
  Parameters: {"booking_id"=>"86", "start_at"=>"Tue Aug 06 2013 00:00:00 GMT+0200 (SAST)", "end_at"=>"Wed Aug 07 2013 00:00:00 GMT+0200 (SAST)", "_"=>"1374859937153", "bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1[0m
  [1m[35mBooking Load (0.2ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "bookings"."id" AS t0_r0, "bookings"."guest_id" AS t0_r1, "bookings"."active" AS t0_r2, "bookings"."created_at" AS t0_r3, "bookings"."updated_at" AS t0_r4, "bookings"."status" AS t0_r5, "bookings"."bnb_id" AS t0_r6, "bookings"."user_id" AS t0_r7, "bookings"."online" AS t0_r8, "bookings"."rate_id" AS t0_r9, "events"."id" AS t1_r0, "events"."name" AS t1_r1, "events"."start_at" AS t1_r2, "events"."end_at" AS t1_r3, "events"."created_at" AS t1_r4, "events"."updated_at" AS t1_r5, "events"."booking_id" AS t1_r6, "events"."color" AS t1_r7, "rooms"."id" AS t2_r0, "rooms"."description" AS t2_r1, "rooms"."en_suite" AS t2_r2, "rooms"."rates" AS t2_r3, "rooms"."extras" AS t2_r4, "rooms"."created_at" AS t2_r5, "rooms"."updated_at" AS t2_r6, "rooms"."bnb_id" AS t2_r7, "rooms"."room_number" AS t2_r8, "rooms"."available" AS t2_r9, "rooms"."capacity" AS t2_r10 FROM "bookings" LEFT OUTER JOIN "events" ON "events"."booking_id" = "bookings"."id" LEFT OUTER JOIN "bookings_rooms" ON "bookings_rooms"."booking_id" = "bookings"."id" LEFT OUTER JOIN "rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings"."active" = 't' AND (events.start_at <= '2013-08-07' AND events.end_at >= '2013-08-06')[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1 AND (id NOT IN (select id from rooms where id in (17,18)))[0m
  Rendered bookings/_unbooked_rooms.html.erb (4.0ms)
  Rendered rooms/find_available.js.erb (7.4ms)
Completed 200 OK in 349ms (Views: 13.1ms | ActiveRecord: 4.4ms)


Started PUT "/bookings/86" for 127.0.0.1 at 2013-07-26 19:32:23 +0200
Processing by BookingsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"3e3WSRadWc/zgvjFqair2+WuSKNCgsiurXj4p02dnNg=", "booking"=>{"event_attributes"=>{"start_at"=>"2013-08-06 00:00:00.000000", "end_at"=>"2013-08-07 00:00:00.000000", "id"=>"91"}, "rate_id"=>"18", "guest_attributes"=>{"name"=>"James", "surname"=>"Johnson", "contact_number"=>"0435567979", "email"=>"tim@bob.com", "id"=>"78"}, "room_ids"=>["17", ""]}, "commit"=>"Update Booking", "id"=>"86"}
  [1m[35mBooking Load (0.1ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mRoom Load (0.3ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."id" = ? LIMIT 1[0m  [["id", 17]]
  [1m[35mRoom Load (0.1ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  [1m[36m (0.4ms)[0m  [1mDELETE FROM "bookings_rooms" WHERE "bookings_rooms"."booking_id" = 86 AND "bookings_rooms"."room_id" IN (18)[0m
  [1m[35mEvent Load (0.1ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mGuest Load (0.1ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mRate Load (0.1ms)[0m  SELECT "rates".* FROM "rates" WHERE "rates"."id" = 18 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mUPDATE "events" SET "start_at" = '2013-08-05 22:00:00.000000', "end_at" = '2013-08-06 22:00:00.000000', "updated_at" = '2013-07-26 17:32:24.112304' WHERE "events"."id" = 91[0m
  [1m[35mBooking Load (0.1ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = 86 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "bookings" SET "updated_at" = '2013-07-26 17:32:24.119860' WHERE "bookings"."id" = 86[0m
  [1m[35mBnb Load (0.1ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  [1m[36m (1.1ms)[0m  [1mcommit transaction[0m
Redirected to http://localhost:3000/bnbs/fish-eagle-villa/bookings
Completed 302 Found in 317ms (ActiveRecord: 0.0ms)


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:32:24 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered bookings/index.html.erb within layouts/application (1.1ms)
  Rendered layouts/_shim.html.erb (0.0ms)
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (1.4ms)
  Rendered layouts/_header.html.erb (8.1ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (1.6ms)
Completed 200 OK in 118ms (Views: 104.0ms | ActiveRecord: 0.7ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374859944427" for 127.0.0.1 at 2013-07-26 19:32:24 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374859944427"}
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  SELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)
Completed 200 OK in 221ms (Views: 45.9ms | ActiveRecord: 0.9ms)


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:33:29 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  Rendered bookings/index.html.erb within layouts/application (1.1ms)
  Rendered layouts/_shim.html.erb (0.1ms)
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  Rendered layouts/_owner_menu_items.html.erb (1.3ms)
  Rendered layouts/_header.html.erb (8.2ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (1.0ms)
Completed 200 OK in 337ms (Views: 115.2ms | ActiveRecord: 2.2ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374860010763" for 127.0.0.1 at 2013-07-26 19:33:31 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374860010763"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)[0m
Completed 200 OK in 224ms (Views: 126.4ms | ActiveRecord: 1.1ms)


Started GET "/bookings/86?_=1374860010764" for 127.0.0.1 at 2013-07-26 19:33:32 +0200
Processing by BookingsController#show as JS
  Parameters: {"_"=>"1374860010764", "id"=>"86"}
  [1m[35mBooking Load (0.4ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mGuest Load (0.2ms)[0m  SELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1
  [1m[36mEvent Load (0.5ms)[0m  [1mSELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1[0m
  [1m[35mRoom Load (0.3ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  Rendered bookings/_show.html.erb (170.4ms)
  Rendered bookings/show.js.erb (174.5ms)
Completed 200 OK in 223ms (Views: 182.4ms | ActiveRecord: 3.9ms)


Started GET "/bookings/86/edit" for 127.0.0.1 at 2013-07-26 19:33:35 +0200
Processing by BookingsController#edit as HTML
  Parameters: {"id"=>"86"}
  [1m[35mBooking Load (0.2ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered shared/_error_messages.html.erb (1.0ms)
  [1m[35mEvent Load (0.2ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1[0m
  [1m[35mRate Load (0.2ms)[0m  SELECT "rates".* FROM "rates" WHERE "rates"."rateable_id" = 1 AND "rates"."rateable_type" = 'Bnb'
  [1m[36mGuest Load (0.3ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mRoom Load (0.3ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  Rendered bookings/edit.html.erb within layouts/application (290.5ms)
  Rendered layouts/_shim.html.erb (0.1ms)
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  Rendered layouts/_owner_menu_items.html.erb (2.3ms)
  Rendered layouts/_header.html.erb (10.0ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (0.9ms)
Completed 200 OK in 634ms (Views: 433.1ms | ActiveRecord: 5.8ms)


Started GET "/bnbs/fish-eagle-villa/rooms/find_available?booking_id=86&start_at=Tue+Aug+06+2013+00%3A00%3A00+GMT%2B0200+(SAST)&end_at=Wed+Aug+07+2013+00%3A00%3A00+GMT%2B0200+(SAST)&_=1374860010765" for 127.0.0.1 at 2013-07-26 19:33:38 +0200
Processing by RoomsController#find_available as JS
  Parameters: {"booking_id"=>"86", "start_at"=>"Tue Aug 06 2013 00:00:00 GMT+0200 (SAST)", "end_at"=>"Wed Aug 07 2013 00:00:00 GMT+0200 (SAST)", "_"=>"1374860010765", "bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1
  [1m[36mBooking Load (0.2ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mSQL (0.3ms)[0m  SELECT "bookings"."id" AS t0_r0, "bookings"."guest_id" AS t0_r1, "bookings"."active" AS t0_r2, "bookings"."created_at" AS t0_r3, "bookings"."updated_at" AS t0_r4, "bookings"."status" AS t0_r5, "bookings"."bnb_id" AS t0_r6, "bookings"."user_id" AS t0_r7, "bookings"."online" AS t0_r8, "bookings"."rate_id" AS t0_r9, "events"."id" AS t1_r0, "events"."name" AS t1_r1, "events"."start_at" AS t1_r2, "events"."end_at" AS t1_r3, "events"."created_at" AS t1_r4, "events"."updated_at" AS t1_r5, "events"."booking_id" AS t1_r6, "events"."color" AS t1_r7, "rooms"."id" AS t2_r0, "rooms"."description" AS t2_r1, "rooms"."en_suite" AS t2_r2, "rooms"."rates" AS t2_r3, "rooms"."extras" AS t2_r4, "rooms"."created_at" AS t2_r5, "rooms"."updated_at" AS t2_r6, "rooms"."bnb_id" AS t2_r7, "rooms"."room_number" AS t2_r8, "rooms"."available" AS t2_r9, "rooms"."capacity" AS t2_r10 FROM "bookings" LEFT OUTER JOIN "events" ON "events"."booking_id" = "bookings"."id" LEFT OUTER JOIN "bookings_rooms" ON "bookings_rooms"."booking_id" = "bookings"."id" LEFT OUTER JOIN "rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings"."active" = 't' AND (events.start_at <= '2013-08-07' AND events.end_at >= '2013-08-06')
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35mRoom Load (0.3ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1 AND (id NOT IN (select id from rooms where id in (17)))
  [1m[36m (0.3ms)[0m  [1mINSERT INTO "bookings_rooms" ("booking_id", "room_id") VALUES (86, 18)[0m
  [1m[35m (2.1ms)[0m  commit transaction
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  Rendered bookings/_unbooked_rooms.html.erb (9.3ms)
  Rendered rooms/find_available.js.erb (12.9ms)
Completed 200 OK in 194ms (Views: 18.7ms | ActiveRecord: 4.9ms)


Started PUT "/bookings/86" for 127.0.0.1 at 2013-07-26 19:33:42 +0200
Processing by BookingsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"3e3WSRadWc/zgvjFqair2+WuSKNCgsiurXj4p02dnNg=", "booking"=>{"event_attributes"=>{"start_at"=>"2013-08-05 22:00:00.000000", "end_at"=>"2013-08-06 22:00:00.000000", "id"=>"91"}, "rate_id"=>"18", "guest_attributes"=>{"name"=>"James", "surname"=>"Johnson", "contact_number"=>"0435567979", "email"=>"tim@bob.com", "id"=>"78"}, "room_ids"=>["17", ""]}, "commit"=>"Update Booking", "id"=>"86"}
  [1m[35mBooking Load (0.2ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."id" = ? LIMIT 1[0m  [["id", 17]]
  [1m[35mRoom Load (0.1ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  [1m[36m (0.3ms)[0m  [1mDELETE FROM "bookings_rooms" WHERE "bookings_rooms"."booking_id" = 86 AND "bookings_rooms"."room_id" IN (18)[0m
  [1m[35mEvent Load (0.1ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mGuest Load (0.1ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mRate Load (0.2ms)[0m  SELECT "rates".* FROM "rates" WHERE "rates"."id" = 18 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mUPDATE "events" SET "start_at" = '2013-08-05 20:00:00.000000', "end_at" = '2013-08-06 20:00:00.000000', "updated_at" = '2013-07-26 17:33:42.639733' WHERE "events"."id" = 91[0m
  [1m[35mBooking Load (0.1ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = 86 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "bookings" SET "updated_at" = '2013-07-26 17:33:42.647019' WHERE "bookings"."id" = 86[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  [1m[36m (1.2ms)[0m  [1mcommit transaction[0m
Redirected to http://localhost:3000/bnbs/fish-eagle-villa/bookings
Completed 302 Found in 219ms (ActiveRecord: 0.0ms)


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:33:42 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered bookings/index.html.erb within layouts/application (1.4ms)
  Rendered layouts/_shim.html.erb (0.1ms)
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (2.0ms)
  Rendered layouts/_header.html.erb (9.6ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (0.9ms)
Completed 200 OK in 51ms (Views: 36.7ms | ActiveRecord: 0.7ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374860022897" for 127.0.0.1 at 2013-07-26 19:33:43 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374860022897"}
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)
Completed 200 OK in 116ms (Views: 106.0ms | ActiveRecord: 0.6ms)


Started GET "/bookings/86?_=1374860022898" for 127.0.0.1 at 2013-07-26 19:33:44 +0200
Processing by BookingsController#show as JS
  Parameters: {"_"=>"1374860022898", "id"=>"86"}
  [1m[36mBooking Load (0.2ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mUser Load (0.5ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mGuest Load (0.2ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mEvent Load (0.4ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  Rendered bookings/_show.html.erb (37.3ms)
  Rendered bookings/show.js.erb (41.8ms)
Completed 200 OK in 73ms (Views: 49.1ms | ActiveRecord: 2.0ms)


Started GET "/bookings/86/edit" for 127.0.0.1 at 2013-07-26 19:33:46 +0200
Processing by BookingsController#edit as HTML
  Parameters: {"id"=>"86"}
  [1m[35mBooking Load (0.3ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered shared/_error_messages.html.erb (0.6ms)
  [1m[35mEvent Load (0.2ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1[0m
  [1m[35mRate Load (0.1ms)[0m  SELECT "rates".* FROM "rates" WHERE "rates"."rateable_id" = 1 AND "rates"."rateable_type" = 'Bnb'
  [1m[36mGuest Load (0.2ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  Rendered bookings/edit.html.erb within layouts/application (57.0ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  Rendered layouts/_owner_menu_items.html.erb (2.1ms)
  Rendered layouts/_header.html.erb (10.8ms)
  Rendered shared/_flash_messages.html.erb (0.6ms)
  Rendered layouts/_footer.html.erb (2.1ms)
Completed 200 OK in 234ms (Views: 93.2ms | ActiveRecord: 2.1ms)


Started GET "/bnbs/fish-eagle-villa/rooms/find_available?booking_id=86&start_at=Mon+Aug+05+2013+00%3A00%3A00+GMT%2B0200+(SAST)&end_at=Tue+Aug+06+2013+00%3A00%3A00+GMT%2B0200+(SAST)&_=1374860022899" for 127.0.0.1 at 2013-07-26 19:33:49 +0200
Processing by RoomsController#find_available as JS
  Parameters: {"booking_id"=>"86", "start_at"=>"Mon Aug 05 2013 00:00:00 GMT+0200 (SAST)", "end_at"=>"Tue Aug 06 2013 00:00:00 GMT+0200 (SAST)", "_"=>"1374860022899", "bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.3ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mRoom Load (0.3ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1[0m
  [1m[35mBooking Load (0.2ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mSQL (0.3ms)[0m  [1mSELECT "bookings"."id" AS t0_r0, "bookings"."guest_id" AS t0_r1, "bookings"."active" AS t0_r2, "bookings"."created_at" AS t0_r3, "bookings"."updated_at" AS t0_r4, "bookings"."status" AS t0_r5, "bookings"."bnb_id" AS t0_r6, "bookings"."user_id" AS t0_r7, "bookings"."online" AS t0_r8, "bookings"."rate_id" AS t0_r9, "events"."id" AS t1_r0, "events"."name" AS t1_r1, "events"."start_at" AS t1_r2, "events"."end_at" AS t1_r3, "events"."created_at" AS t1_r4, "events"."updated_at" AS t1_r5, "events"."booking_id" AS t1_r6, "events"."color" AS t1_r7, "rooms"."id" AS t2_r0, "rooms"."description" AS t2_r1, "rooms"."en_suite" AS t2_r2, "rooms"."rates" AS t2_r3, "rooms"."extras" AS t2_r4, "rooms"."created_at" AS t2_r5, "rooms"."updated_at" AS t2_r6, "rooms"."bnb_id" AS t2_r7, "rooms"."room_number" AS t2_r8, "rooms"."available" AS t2_r9, "rooms"."capacity" AS t2_r10 FROM "bookings" LEFT OUTER JOIN "events" ON "events"."booking_id" = "bookings"."id" LEFT OUTER JOIN "bookings_rooms" ON "bookings_rooms"."booking_id" = "bookings"."id" LEFT OUTER JOIN "rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings"."active" = 't' AND (events.start_at <= '2013-08-06' AND events.end_at >= '2013-08-05')[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36mRoom Load (0.3ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1 AND (id NOT IN (select id from rooms where id in (17)))[0m
  [1m[35m (0.3ms)[0m  INSERT INTO "bookings_rooms" ("booking_id", "room_id") VALUES (86, 18)
  [1m[36m (1.6ms)[0m  [1mcommit transaction[0m
  [1m[35mRoom Load (0.3ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  Rendered bookings/_unbooked_rooms.html.erb (10.5ms)
  Rendered rooms/find_available.js.erb (14.0ms)
Completed 200 OK in 62ms (Views: 22.3ms | ActiveRecord: 3.9ms)


Started PUT "/bookings/86" for 127.0.0.1 at 2013-07-26 19:33:52 +0200
Processing by BookingsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"3e3WSRadWc/zgvjFqair2+WuSKNCgsiurXj4p02dnNg=", "booking"=>{"event_attributes"=>{"start_at"=>"2013-08-05 20:00:00.000000", "end_at"=>"2013-08-06 20:00:00.000000", "id"=>"91"}, "rate_id"=>"18", "guest_attributes"=>{"name"=>"James", "surname"=>"Johnson", "contact_number"=>"0435567979", "email"=>"tim@bob.com", "id"=>"78"}, "room_ids"=>["17", ""]}, "commit"=>"Update Booking", "id"=>"86"}
  [1m[36mBooking Load (0.1ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mUser Load (0.3ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."id" = ? LIMIT 1  [["id", 17]]
  [1m[36mRoom Load (0.1ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  [1m[35m (0.3ms)[0m  DELETE FROM "bookings_rooms" WHERE "bookings_rooms"."booking_id" = 86 AND "bookings_rooms"."room_id" IN (18)
  [1m[36mEvent Load (0.1ms)[0m  [1mSELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1[0m
  [1m[35mGuest Load (0.1ms)[0m  SELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1
  [1m[36mRate Load (0.2ms)[0m  [1mSELECT "rates".* FROM "rates" WHERE "rates"."id" = 18 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  UPDATE "events" SET "start_at" = '2013-08-05 18:00:00.000000', "end_at" = '2013-08-06 18:00:00.000000', "updated_at" = '2013-07-26 17:33:52.770011' WHERE "events"."id" = 91
  [1m[36mBooking Load (0.1ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = 86 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  UPDATE "bookings" SET "updated_at" = '2013-07-26 17:33:52.776034' WHERE "bookings"."id" = 86
  [1m[36mBnb Load (0.1ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1[0m
  [1m[35m (1.0ms)[0m  commit transaction
Redirected to http://localhost:3000/bnbs/fish-eagle-villa/bookings
Completed 302 Found in 150ms (ActiveRecord: 0.0ms)


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:33:52 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  Rendered bookings/index.html.erb within layouts/application (1.6ms)
  Rendered layouts/_shim.html.erb (0.0ms)
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  Rendered layouts/_owner_menu_items.html.erb (1.3ms)
  Rendered layouts/_header.html.erb (7.9ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (1.0ms)
Completed 200 OK in 46ms (Views: 31.7ms | ActiveRecord: 0.6ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374860033014" for 127.0.0.1 at 2013-07-26 19:33:53 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374860033014"}
  [1m[35mUser Load (0.3ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  SELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)
Completed 200 OK in 57ms (Views: 45.3ms | ActiveRecord: 0.6ms)


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:34:15 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered bookings/index.html.erb within layouts/application (1.0ms)
  Rendered layouts/_shim.html.erb (0.0ms)
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (1.3ms)
  Rendered layouts/_header.html.erb (8.2ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (1.0ms)
Completed 200 OK in 249ms (Views: 32.7ms | ActiveRecord: 2.0ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374860057037" for 127.0.0.1 at 2013-07-26 19:34:17 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374860057037"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)[0m
Completed 200 OK in 83ms (Views: 69.4ms | ActiveRecord: 1.1ms)


Started GET "/bookings/86?_=1374860057038" for 127.0.0.1 at 2013-07-26 19:34:19 +0200
Processing by BookingsController#show as JS
  Parameters: {"_"=>"1374860057038", "id"=>"86"}
  [1m[36mBooking Load (0.2ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mGuest Load (0.1ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mEvent Load (0.1ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  Rendered bookings/_show.html.erb (123.8ms)
  Rendered bookings/show.js.erb (127.1ms)
Completed 200 OK in 326ms (Views: 133.0ms | ActiveRecord: 3.3ms)


Started GET "/bookings/86/edit" for 127.0.0.1 at 2013-07-26 19:34:21 +0200
Processing by BookingsController#edit as HTML
  Parameters: {"id"=>"86"}
  [1m[36mBooking Load (0.2ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  Rendered shared/_error_messages.html.erb (0.1ms)
  [1m[36mEvent Load (0.1ms)[0m  [1mSELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  [1m[36mRate Load (0.2ms)[0m  [1mSELECT "rates".* FROM "rates" WHERE "rates"."rateable_id" = 1 AND "rates"."rateable_type" = 'Bnb'[0m
  [1m[35mGuest Load (0.2ms)[0m  SELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  Rendered bookings/edit.html.erb within layouts/application (202.5ms)
  Rendered layouts/_shim.html.erb (0.0ms)
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (1.3ms)
  Rendered layouts/_header.html.erb (8.2ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (0.9ms)
Completed 200 OK in 430ms (Views: 232.6ms | ActiveRecord: 5.0ms)


Started GET "/bnbs/fish-eagle-villa/rooms/find_available?booking_id=86&start_at=Mon+Aug+05+2013+00%3A00%3A00+GMT%2B0200+(SAST)&end_at=Tue+Aug+06+2013+00%3A00%3A00+GMT%2B0200+(SAST)&_=1374860057039" for 127.0.0.1 at 2013-07-26 19:34:24 +0200
Processing by RoomsController#find_available as JS
  Parameters: {"booking_id"=>"86", "start_at"=>"Mon Aug 05 2013 00:00:00 GMT+0200 (SAST)", "end_at"=>"Tue Aug 06 2013 00:00:00 GMT+0200 (SAST)", "_"=>"1374860057039", "bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1
  [1m[36mBooking Load (0.1ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mSQL (0.6ms)[0m  SELECT "bookings"."id" AS t0_r0, "bookings"."guest_id" AS t0_r1, "bookings"."active" AS t0_r2, "bookings"."created_at" AS t0_r3, "bookings"."updated_at" AS t0_r4, "bookings"."status" AS t0_r5, "bookings"."bnb_id" AS t0_r6, "bookings"."user_id" AS t0_r7, "bookings"."online" AS t0_r8, "bookings"."rate_id" AS t0_r9, "events"."id" AS t1_r0, "events"."name" AS t1_r1, "events"."start_at" AS t1_r2, "events"."end_at" AS t1_r3, "events"."created_at" AS t1_r4, "events"."updated_at" AS t1_r5, "events"."booking_id" AS t1_r6, "events"."color" AS t1_r7, "rooms"."id" AS t2_r0, "rooms"."description" AS t2_r1, "rooms"."en_suite" AS t2_r2, "rooms"."rates" AS t2_r3, "rooms"."extras" AS t2_r4, "rooms"."created_at" AS t2_r5, "rooms"."updated_at" AS t2_r6, "rooms"."bnb_id" AS t2_r7, "rooms"."room_number" AS t2_r8, "rooms"."available" AS t2_r9, "rooms"."capacity" AS t2_r10 FROM "bookings" LEFT OUTER JOIN "events" ON "events"."booking_id" = "bookings"."id" LEFT OUTER JOIN "bookings_rooms" ON "bookings_rooms"."booking_id" = "bookings"."id" LEFT OUTER JOIN "rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings"."active" = 't' AND (events.start_at <= '2013-08-06' AND events.end_at >= '2013-08-05')
  [1m[36mRoom Load (0.4ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1 AND (id NOT IN (select id from rooms where id in (17)))[0m
  [1m[35mRoom Load (0.3ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  Rendered bookings/_unbooked_rooms.html.erb (7.7ms)
  Rendered rooms/find_available.js.erb (15.3ms)
Completed 200 OK in 208ms (Views: 25.7ms | ActiveRecord: 2.6ms)


Started PUT "/bookings/86" for 127.0.0.1 at 2013-07-26 19:34:29 +0200
Processing by BookingsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"3e3WSRadWc/zgvjFqair2+WuSKNCgsiurXj4p02dnNg=", "booking"=>{"event_attributes"=>{"start_at"=>"2013-08-05 18:00:00.000000", "end_at"=>"2013-08-06 18:00:00.000000", "id"=>"91"}, "rate_id"=>"18", "guest_attributes"=>{"name"=>"James", "surname"=>"Johnson", "contact_number"=>"0435567979", "email"=>"tim@bob.com", "id"=>"78"}, "room_ids"=>["18", "17", ""]}, "commit"=>"Update Booking", "id"=>"86"}
  [1m[36mBooking Load (0.1ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."id" IN (18, 17)
  [1m[36mRoom Load (0.1ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  [1m[35m (0.3ms)[0m  INSERT INTO "bookings_rooms" ("booking_id", "room_id") VALUES (86, 18)
  [1m[36mEvent Load (0.1ms)[0m  [1mSELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1[0m
  [1m[35mGuest Load (0.1ms)[0m  SELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1
  [1m[36mRate Load (0.1ms)[0m  [1mSELECT "rates".* FROM "rates" WHERE "rates"."id" = 18 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  UPDATE "events" SET "start_at" = '2013-08-05 16:00:00.000000', "end_at" = '2013-08-06 16:00:00.000000', "updated_at" = '2013-07-26 17:34:29.212480' WHERE "events"."id" = 91
  [1m[36mBooking Load (0.1ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = 86 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  UPDATE "bookings" SET "updated_at" = '2013-07-26 17:34:29.218792' WHERE "bookings"."id" = 86
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1[0m
  [1m[35m (1.2ms)[0m  commit transaction
Redirected to http://localhost:3000/bnbs/fish-eagle-villa/bookings
Completed 302 Found in 143ms (ActiveRecord: 0.0ms)


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:34:29 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered bookings/index.html.erb within layouts/application (1.1ms)
  Rendered layouts/_shim.html.erb (0.0ms)
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (1.6ms)
  Rendered layouts/_header.html.erb (11.1ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (1.0ms)
Completed 200 OK in 137ms (Views: 119.5ms | ActiveRecord: 0.9ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374860069642" for 127.0.0.1 at 2013-07-26 19:34:30 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374860069642"}
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)[0m
Completed 200 OK in 39ms (Views: 28.7ms | ActiveRecord: 0.6ms)
Connecting to database specified by database.yml
Connecting to database specified by database.yml
SQLite3::SQLException: no such column: rooms.bookings: SELECT "rooms".* FROM "rooms"  WHERE "rooms"."bookings" IS NULL
Connecting to database specified by database.yml


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:46:28 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  Rendered bookings/index.html.erb within layouts/application (30.5ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  Rendered layouts/_owner_menu_items.html.erb (2.3ms)
  Rendered layouts/_header.html.erb (79.9ms)
  Rendered shared/_flash_messages.html.erb (0.6ms)
  Rendered layouts/_footer.html.erb (1.9ms)
Completed 200 OK in 372ms (Views: 152.1ms | ActiveRecord: 2.3ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374860790625" for 127.0.0.1 at 2013-07-26 19:46:30 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374860790625"}
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mSELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)[0m
Completed 200 OK in 310ms (Views: 129.6ms | ActiveRecord: 1.0ms)


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:46:57 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered bookings/index.html.erb within layouts/application (0.9ms)
  Rendered layouts/_shim.html.erb (0.0ms)
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (1.3ms)
  Rendered layouts/_header.html.erb (7.3ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (0.9ms)
Completed 200 OK in 44ms (Views: 30.4ms | ActiveRecord: 0.6ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374860819179" for 127.0.0.1 at 2013-07-26 19:46:59 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374860819179"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mBnb Load (0.3ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mSELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)[0m
Completed 200 OK in 202ms (Views: 153.8ms | ActiveRecord: 1.6ms)


Started GET "/bookings/86?_=1374860819180" for 127.0.0.1 at 2013-07-26 19:47:08 +0200
Processing by BookingsController#show as JS
  Parameters: {"_"=>"1374860819180", "id"=>"86"}
  [1m[36mBooking Load (0.7ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mGuest Load (0.2ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mEvent Load (0.1ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mRoom Load (0.2ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  Rendered bookings/_show.html.erb (137.2ms)
  Rendered bookings/show.js.erb (209.7ms)
Completed 200 OK in 430ms (Views: 216.8ms | ActiveRecord: 5.4ms)


Started GET "/bookings/86/edit" for 127.0.0.1 at 2013-07-26 19:47:11 +0200
Processing by BookingsController#edit as HTML
  Parameters: {"id"=>"86"}
  [1m[35mBooking Load (0.7ms)[0m  SELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1  [["id", "86"]]
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered shared/_error_messages.html.erb (1.6ms)
  [1m[35mEvent Load (0.4ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1[0m
  [1m[35mRate Load (0.2ms)[0m  SELECT "rates".* FROM "rates" WHERE "rates"."rateable_id" = 1 AND "rates"."rateable_type" = 'Bnb'
  [1m[36mGuest Load (0.2ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  Rendered bookings/edit.html.erb within layouts/application (196.5ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  Rendered layouts/_owner_menu_items.html.erb (2.2ms)
  Rendered layouts/_header.html.erb (10.2ms)
  Rendered shared/_flash_messages.html.erb (0.6ms)
  Rendered layouts/_footer.html.erb (1.6ms)
Completed 200 OK in 251ms (Views: 233.1ms | ActiveRecord: 3.8ms)


Started GET "/bnbs/fish-eagle-villa/rooms/find_available?booking_id=86&start_at=Mon+Aug+05+2013+00%3A00%3A00+GMT%2B0200+(SAST)&end_at=Tue+Aug+06+2013+00%3A00%3A00+GMT%2B0200+(SAST)&_=1374860819181" for 127.0.0.1 at 2013-07-26 19:47:14 +0200
Processing by RoomsController#find_available as JS
  Parameters: {"booking_id"=>"86", "start_at"=>"Mon Aug 05 2013 00:00:00 GMT+0200 (SAST)", "end_at"=>"Tue Aug 06 2013 00:00:00 GMT+0200 (SAST)", "_"=>"1374860819181", "bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35mRoom Load (0.1ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1
  [1m[36mBooking Load (0.3ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mSQL (0.3ms)[0m  SELECT "bookings"."id" AS t0_r0, "bookings"."guest_id" AS t0_r1, "bookings"."active" AS t0_r2, "bookings"."created_at" AS t0_r3, "bookings"."updated_at" AS t0_r4, "bookings"."status" AS t0_r5, "bookings"."bnb_id" AS t0_r6, "bookings"."user_id" AS t0_r7, "bookings"."online" AS t0_r8, "bookings"."rate_id" AS t0_r9, "events"."id" AS t1_r0, "events"."name" AS t1_r1, "events"."start_at" AS t1_r2, "events"."end_at" AS t1_r3, "events"."created_at" AS t1_r4, "events"."updated_at" AS t1_r5, "events"."booking_id" AS t1_r6, "events"."color" AS t1_r7, "rooms"."id" AS t2_r0, "rooms"."description" AS t2_r1, "rooms"."en_suite" AS t2_r2, "rooms"."rates" AS t2_r3, "rooms"."extras" AS t2_r4, "rooms"."created_at" AS t2_r5, "rooms"."updated_at" AS t2_r6, "rooms"."bnb_id" AS t2_r7, "rooms"."room_number" AS t2_r8, "rooms"."available" AS t2_r9, "rooms"."capacity" AS t2_r10 FROM "bookings" LEFT OUTER JOIN "events" ON "events"."booking_id" = "bookings"."id" LEFT OUTER JOIN "bookings_rooms" ON "bookings_rooms"."booking_id" = "bookings"."id" LEFT OUTER JOIN "rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings"."active" = 't' AND (events.start_at <= '2013-08-06' AND events.end_at >= '2013-08-05')
  [1m[36mRoom Load (0.3ms)[0m  [1mSELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1 AND (id NOT IN (select id from rooms where id in (17,18)))[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86
  Rendered bookings/_unbooked_rooms.html.erb (6.6ms)
  Rendered rooms/find_available.js.erb (13.4ms)
Completed 200 OK in 173ms (Views: 20.3ms | ActiveRecord: 2.3ms)


Started PUT "/bookings/86" for 127.0.0.1 at 2013-07-26 19:47:16 +0200
Processing by BookingsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"3e3WSRadWc/zgvjFqair2+WuSKNCgsiurXj4p02dnNg=", "booking"=>{"event_attributes"=>{"start_at"=>"2013-08-05 16:00:00.000000", "end_at"=>"2013-08-06 16:00:00.000000", "id"=>"91"}, "rate_id"=>"18", "guest_attributes"=>{"name"=>"James", "surname"=>"Johnson", "contact_number"=>"0435567979", "email"=>"tim@bob.com", "id"=>"78"}, "room_ids"=>["17", ""]}, "commit"=>"Update Booking", "id"=>"86"}
  [1m[36mBooking Load (0.2ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."id" = ? LIMIT 1  [["id", 17]]
  [1m[36mRoom Load (0.1ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  [1m[35m (0.5ms)[0m  DELETE FROM "bookings_rooms" WHERE "bookings_rooms"."booking_id" = 86 AND "bookings_rooms"."room_id" IN (18)
  [1m[36mEvent Load (0.1ms)[0m  [1mSELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1[0m
  [1m[35mGuest Load (0.1ms)[0m  SELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1
  [1m[36mRate Load (0.1ms)[0m  [1mSELECT "rates".* FROM "rates" WHERE "rates"."id" = 18 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  UPDATE "events" SET "start_at" = '2013-08-05 14:00:00.000000', "end_at" = '2013-08-06 14:00:00.000000', "updated_at" = '2013-07-26 17:47:17.124775' WHERE "events"."id" = 91
  [1m[36mBooking Load (0.1ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = 86 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "bookings" SET "updated_at" = '2013-07-26 17:47:17.131049' WHERE "bookings"."id" = 86
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1[0m
  [1m[35m (1.3ms)[0m  commit transaction
Redirected to http://localhost:3000/bnbs/fish-eagle-villa/bookings
Completed 302 Found in 243ms (ActiveRecord: 0.0ms)


Started GET "/bnbs/fish-eagle-villa/bookings" for 127.0.0.1 at 2013-07-26 19:47:17 +0200
Processing by BookingsController#index as HTML
  Parameters: {"bnb_id"=>"fish-eagle-villa"}
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered bookings/index.html.erb within layouts/application (18.1ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1
  Rendered layouts/_owner_menu_items.html.erb (2.5ms)
  Rendered layouts/_header.html.erb (80.8ms)
  Rendered shared/_flash_messages.html.erb (0.7ms)
  Rendered layouts/_footer.html.erb (1.8ms)
Completed 200 OK in 174ms (Views: 131.2ms | ActiveRecord: 1.1ms)


Started GET "/events?start=1372543200&end=1376172000&_=1374860837746" for 127.0.0.1 at 2013-07-26 19:47:17 +0200
Processing by EventsController#index as JSON
  Parameters: {"start"=>"1372543200", "end"=>"1376172000", "_"=>"1374860837746"}
  [1m[35mUser Load (0.5ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."user_id" = 1 ORDER BY "bnbs"."id" DESC LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  SELECT "events"."id" AS t0_r0, "events"."name" AS t0_r1, "events"."start_at" AS t0_r2, "events"."end_at" AS t0_r3, "events"."created_at" AS t0_r4, "events"."updated_at" AS t0_r5, "events"."booking_id" AS t0_r6, "events"."color" AS t0_r7, "bookings"."id" AS t1_r0, "bookings"."guest_id" AS t1_r1, "bookings"."active" AS t1_r2, "bookings"."created_at" AS t1_r3, "bookings"."updated_at" AS t1_r4, "bookings"."status" AS t1_r5, "bookings"."bnb_id" AS t1_r6, "bookings"."user_id" AS t1_r7, "bookings"."online" AS t1_r8, "bookings"."rate_id" AS t1_r9, "bnbs"."id" AS t2_r0, "bnbs"."name" AS t2_r1, "bnbs"."description" AS t2_r2, "bnbs"."email" AS t2_r3, "bnbs"."address_line_one" AS t2_r4, "bnbs"."address_line_two" AS t2_r5, "bnbs"."city" AS t2_r6, "bnbs"."postal_code" AS t2_r7, "bnbs"."country" AS t2_r8, "bnbs"."telephone_number" AS t2_r9, "bnbs"."website" AS t2_r10, "bnbs"."contact_person" AS t2_r11, "bnbs"."twitter_account" AS t2_r12, "bnbs"."facebook_page" AS t2_r13, "bnbs"."created_at" AS t2_r14, "bnbs"."updated_at" AS t2_r15, "bnbs"."user_id" AS t2_r16, "bnbs"."latitude" AS t2_r17, "bnbs"."longitude" AS t2_r18, "bnbs"."rating" AS t2_r19, "bnbs"."region" AS t2_r20, "bnbs"."slug" AS t2_r21, "bnbs"."approved" AS t2_r22, "bnbs"."mappable" AS t2_r23, "bnbs"."photos_count" AS t2_r24 FROM "events" LEFT OUTER JOIN "bookings" ON "bookings"."id" = "events"."booking_id" LEFT OUTER JOIN "bnbs" ON "bnbs"."id" = "bookings"."bnb_id" WHERE "events"."booking_id" IN (SELECT "bookings"."id" FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."bnb_id" = 1)
Completed 200 OK in 57ms (Views: 41.0ms | ActiveRecord: 1.0ms)


Started GET "/bookings/86?_=1374860837747" for 127.0.0.1 at 2013-07-26 19:47:19 +0200
Processing by BookingsController#show as JS
  Parameters: {"_"=>"1374860837747", "id"=>"86"}
  [1m[36mBooking Load (0.7ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mUser Load (0.5ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mGuest Load (0.2ms)[0m  [1mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 78 LIMIT 1[0m
  [1m[35mEvent Load (0.2ms)[0m  SELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1
  [1m[36mRoom Load (0.3ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  Rendered bookings/_show.html.erb (10.6ms)
  Rendered bookings/show.js.erb (14.4ms)
Completed 200 OK in 45ms (Views: 26.5ms | ActiveRecord: 1.8ms)


Started DELETE "/bookings/86" for 127.0.0.1 at 2013-07-26 19:47:21 +0200
Processing by BookingsController#destroy as JS
  Parameters: {"id"=>"86"}
  [1m[36mBooking Load (0.1ms)[0m  [1mSELECT "bookings".* FROM "bookings" WHERE "bookings"."active" = 't' AND "bookings"."id" = ? LIMIT 1[0m  [["id", "86"]]
  [1m[35mUser Load (0.2ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  DELETE FROM "line_items" WHERE "line_items"."booking_id" = 86
  [1m[36mEvent Load (0.1ms)[0m  [1mSELECT "events".* FROM "events" WHERE "events"."booking_id" = 86 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  DELETE FROM "events" WHERE "events"."id" = 91
  [1m[36mRoom Load (0.1ms)[0m  [1mSELECT "rooms".* FROM "rooms" INNER JOIN "bookings_rooms" ON "rooms"."id" = "bookings_rooms"."room_id" WHERE "bookings_rooms"."booking_id" = 86[0m
  [1m[35m (0.2ms)[0m  DELETE FROM "bookings_rooms" WHERE "bookings_rooms"."booking_id" = 86 AND "bookings_rooms"."room_id" IN (17)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM "bookings" WHERE "bookings"."id" = ?[0m  [["id", 86]]
  [1m[35mBnb Load (0.1ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  [1m[36m (2.7ms)[0m  [1mcommit transaction[0m
  Rendered shared/_flash_messages.html.erb (0.6ms)
  Rendered bookings/destroy.js.erb (4.6ms)
Completed 200 OK in 161ms (Views: 11.3ms | ActiveRecord: 4.5ms)


Started DELETE "/users/sign_out" for 127.0.0.1 at 2013-07-26 19:47:32 +0200
Processing by SessionsController#destroy as HTML
  Parameters: {"authenticity_token"=>"3e3WSRadWc/zgvjFqair2+WuSKNCgsiurXj4p02dnNg="}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36m (0.1ms)[0m  [1mcommit transaction[0m
Redirected to http://localhost:3000/suggestions/new
Completed 302 Found in 17ms (ActiveRecord: 0.5ms)


Started GET "/suggestions/new" for 127.0.0.1 at 2013-07-26 19:47:33 +0200
Processing by SuggestionsController#new as HTML
  Rendered suggestions/_form.html.erb (10.9ms)
  Rendered suggestions/new.html.erb within layouts/application (16.3ms)
  Rendered layouts/_shim.html.erb (0.0ms)
  Rendered layouts/_header.html.erb (2.0ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (1.0ms)
Completed 200 OK in 61ms (Views: 51.0ms | ActiveRecord: 0.4ms)
Connecting to database specified by database.yml
Creating scope :inactive. Overwriting existing method Booking.inactive.
Connecting to database specified by database.yml


Started GET "/" for 127.0.0.1 at 2013-08-23 08:20:35 +0200
Processing by StaticPagesController#home as HTML
  [1m[36mPhoto Load (0.3ms)[0m  [1mSELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" IN (SELECT "bnbs"."id" FROM "bnbs" WHERE "bnbs"."approved" = 't') AND "photos"."processed" = 't' AND "photos"."main" = 't'[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  Rendered static_pages/_carousel_items.html.erb (51.0ms)
  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/gmaps4rails-1.5.6/app/views/gmaps4rails/_gmaps4rails.html.erb (2.9ms)
  Rendered static_pages/home.html.erb within layouts/application (263.6ms)
Compiled static_pages.js  (201ms)  (pid 93639)
  Rendered layouts/_shim.html.erb (0.6ms)
  Rendered layouts/_header.html.erb (4.3ms)
  Rendered shared/_flash_messages.html.erb (0.8ms)
  Rendered layouts/_footer.html.erb (2.1ms)
Completed 200 OK in 609ms (Views: 531.4ms | ActiveRecord: 2.4ms)


Started GET "/" for 127.0.0.1 at 2013-08-23 08:21:09 +0200
Processing by StaticPagesController#home as HTML
  [1m[36mPhoto Load (0.3ms)[0m  [1mSELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" IN (SELECT "bnbs"."id" FROM "bnbs" WHERE "bnbs"."approved" = 't') AND "photos"."processed" = 't' AND "photos"."main" = 't'[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  Rendered static_pages/_carousel_items.html.erb (116.6ms)
  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/gmaps4rails-1.5.6/app/views/gmaps4rails/_gmaps4rails.html.erb (3.1ms)
  Rendered static_pages/home.html.erb within layouts/application (180.5ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  Rendered layouts/_header.html.erb (2.9ms)
  Rendered shared/_flash_messages.html.erb (0.7ms)
  Rendered layouts/_footer.html.erb (1.7ms)
Completed 200 OK in 370ms (Views: 223.6ms | ActiveRecord: 2.1ms)


Started GET "/" for 127.0.0.1 at 2013-08-23 08:21:17 +0200
Processing by StaticPagesController#home as HTML
  [1m[36mPhoto Load (0.4ms)[0m  [1mSELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" IN (SELECT "bnbs"."id" FROM "bnbs" WHERE "bnbs"."approved" = 't') AND "photos"."processed" = 't' AND "photos"."main" = 't'[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  Rendered static_pages/_carousel_items.html.erb (122.5ms)
  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/gmaps4rails-1.5.6/app/views/gmaps4rails/_gmaps4rails.html.erb (3.4ms)
  Rendered static_pages/home.html.erb within layouts/application (183.4ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  Rendered layouts/_header.html.erb (3.6ms)
  Rendered shared/_flash_messages.html.erb (0.7ms)
  Rendered layouts/_footer.html.erb (2.1ms)
Completed 200 OK in 353ms (Views: 218.9ms | ActiveRecord: 2.2ms)


Started GET "/" for 127.0.0.1 at 2013-08-23 08:25:46 +0200
Processing by StaticPagesController#home as HTML
  [1m[36mPhoto Load (0.3ms)[0m  [1mSELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" IN (SELECT "bnbs"."id" FROM "bnbs" WHERE "bnbs"."approved" = 't') AND "photos"."processed" = 't' AND "photos"."main" = 't'[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  Rendered static_pages/_carousel_items.html.erb (3.2ms)
  Rendered static_pages/home.html.erb within layouts/application (114.5ms)
Completed 500 Internal Server Error in 125ms

ActionView::Template::Error (undefined method `gmaps4' for #<#<Class:0x007f90c4f46800>:0x007f90c837fef0>):
    77:   </div>
    78: </div>
    79: 
    80: <div><%= gmaps4({
    81:                        "direction"   => { "data" => { "from" => "Paris, france", "to" => "Toulon, france" } }
    82:                })
    83: %></div>
  app/views/static_pages/home.html.erb:80:in `_app_views_static_pages_home_html_erb___3940777886869860232_70129905561940'


  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/actionpack-3.2.14/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.6ms)
  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/actionpack-3.2.14/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (1.1ms)
  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/actionpack-3.2.14/lib/action_dispatch/middleware/templates/rescues/template_error.erb within rescues/layout (26.5ms)


Started GET "/" for 127.0.0.1 at 2013-08-23 08:25:56 +0200
Processing by StaticPagesController#home as HTML
  [1m[36mPhoto Load (0.3ms)[0m  [1mSELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" IN (SELECT "bnbs"."id" FROM "bnbs" WHERE "bnbs"."approved" = 't') AND "photos"."processed" = 't' AND "photos"."main" = 't'[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  Rendered static_pages/_carousel_items.html.erb (3.5ms)
  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/gmaps4rails-1.5.6/app/views/gmaps4rails/_gmaps4rails.html.erb (0.9ms)
  Rendered static_pages/home.html.erb within layouts/application (18.5ms)
  Rendered layouts/_shim.html.erb (0.0ms)
  Rendered layouts/_header.html.erb (3.3ms)
  Rendered shared/_flash_messages.html.erb (0.1ms)
  Rendered layouts/_footer.html.erb (1.0ms)
Completed 200 OK in 54ms (Views: 51.7ms | ActiveRecord: 0.5ms)
Connecting to database specified by database.yml


Started GET "/" for 127.0.0.1 at 2013-08-23 08:30:06 +0200
Processing by StaticPagesController#home as HTML
  [1m[36mPhoto Load (0.3ms)[0m  [1mSELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" IN (SELECT "bnbs"."id" FROM "bnbs" WHERE "bnbs"."approved" = 't') AND "photos"."processed" = 't' AND "photos"."main" = 't'[0m
  [1m[35mBnb Load (0.2ms)[0m  SELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."id" = 1 LIMIT 1
  Rendered static_pages/_carousel_items.html.erb (114.5ms)
  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/gmaps4rails-1.5.6/app/views/gmaps4rails/_gmaps4rails.html.erb (2.5ms)
  Rendered static_pages/home.html.erb within layouts/application (189.9ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  Rendered layouts/_header.html.erb (3.7ms)
  Rendered shared/_flash_messages.html.erb (0.7ms)
  Rendered layouts/_footer.html.erb (1.8ms)
Completed 200 OK in 413ms (Views: 241.2ms | ActiveRecord: 2.2ms)


Started GET "/bnbs" for 127.0.0.1 at 2013-08-23 08:30:11 +0200
Processing by BnbsController#index as HTML
  [1m[36mBnb Load (0.2ms)[0m  [1mSELECT id, name, description, city, rating, slug FROM "bnbs" WHERE "bnbs"."approved" = 't' LIMIT 15 OFFSET 0[0m
  [1m[35mPhoto Load (0.2ms)[0m  SELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" = 1 AND "photos"."processed" = 't' AND "photos"."main" = 't' LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" = 1 AND "photos"."processed" = 't' AND "photos"."main" = 't' LIMIT 1[0m
  Rendered bnbs/index.html.erb within layouts/application (167.5ms)
  Rendered layouts/_shim.html.erb (0.4ms)
  Rendered layouts/_header.html.erb (2.8ms)
  Rendered shared/_flash_messages.html.erb (0.7ms)
  Rendered layouts/_footer.html.erb (1.8ms)
Completed 200 OK in 368ms (Views: 206.3ms | ActiveRecord: 3.8ms)


Started GET "/bnb/fish-eagle-villa" for 127.0.0.1 at 2013-08-23 08:30:18 +0200
Processing by BnbsController#show as HTML
  Parameters: {"id"=>"fish-eagle-villa"}
  [1m[36mBnb Load (0.3ms)[0m  [1mSELECT "bnbs".* FROM "bnbs" WHERE "bnbs"."slug" = 'fish-eagle-villa' LIMIT 1[0m
  [1m[35mRoom Load (0.2ms)[0m  SELECT "rooms".* FROM "rooms" WHERE "rooms"."bnb_id" = 1
  Rendered bnbs/_mapinfo.html.erb (42.3ms)
  [1m[36mRate Load (0.2ms)[0m  [1mSELECT "rates".* FROM "rates" WHERE "rates"."rateable_id" = 1 AND "rates"."rateable_type" = 'Bnb'[0m
  [1m[35mPhoto Load (0.2ms)[0m  SELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" = 1 AND "photos"."processed" = 't' AND "photos"."main" = 't' LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" = 1 AND "photos"."processed" = 't' AND "photos"."main" = 't' LIMIT 1[0m
  [1m[35mPhoto Load (0.2ms)[0m  SELECT "photos".* FROM "photos" WHERE "photos"."bnb_id" = 1 AND "photos"."processed" = 't' AND "photos"."main" = 'f'
  Rendered /Users/pauljansevanrensburg/.rvm/gems/ruby-2.0.0-p0@Rails3.2.13/gems/gmaps4rails-1.5.6/app/views/gmaps4rails/_gmaps4rails.html.erb (2.6ms)
  Rendered bnbs/show.html.erb within layouts/application (49.3ms)
  Rendered layouts/_shim.html.erb (0.6ms)
  Rendered layouts/_header.html.erb (3.1ms)
  Rendered shared/_flash_messages.html.erb (0.9ms)
  Rendered layouts/_footer.html.erb (2.2ms)
Completed 200 OK in 363ms (Views: 167.2ms | ActiveRecord: 1.9ms)
Connecting to database specified by database.yml
Connecting to database specified by database.yml
DEPRECATION WARNING: Devise.token_authentication_key= is deprecated and has no effect. (called from token_authentication_key= at (eval):6)
