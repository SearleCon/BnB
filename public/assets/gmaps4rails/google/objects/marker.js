(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Gmaps4Rails.Google.Marker=function(e){function n(e,t){var n;this.controller=t,n=this.createLatLng(e.lat,e.lng),this._isBasicMarker(e)?this._createBasicMarker(n,e):e.rich_marker!=null?this._createRichMarker(n,e):this._createMarker(n,e)}return t(n,e),n.include(Gmaps4Rails.Interfaces.Marker),n.include(Gmaps4Rails.Google.Shared),n.include(Gmaps4Rails.Marker.Instance),n.extend(Gmaps4Rails.Marker.Class),n.extend(Gmaps4Rails.Configuration),n.CONF={clusterer_gridSize:50,clusterer_maxZoom:5,custom_cluster_pictures:null,custom_infowindow_class:null,raw:{}},n.prototype.createInfoWindow=function(){var e;if(typeof this.controller.jsTemplate=="function"||this.description!=null)return typeof this.controller.jsTemplate=="function"&&(this.description=this.controller.jsTemplate(this)),this.controller.markers_conf.custom_infowindow_class!=null?(e=document.createElement("div"),e.setAttribute("class",this.controller.markers_conf.custom_infowindow_class),e.innerHTML=this.description,this.infowindow=new InfoBox(this.infobox(e)),google.maps.event.addListener(this.serviceObject,"click",this._openInfowindow())):(this.infowindow=new google.maps.InfoWindow({content:this.description}),google.maps.event.addListener(this.serviceObject,"click",this._openInfowindow()))},n.prototype._createBasicMarker=function(e,t){var n,r;return n={position:e,map:this.getMap(),title:t.marker_title,draggable:t.marker_draggable,zIndex:t.zindex},r=this.mergeObjects(this.controller.markers_conf.raw,n),this.serviceObject=new google.maps.Marker(r)},n.prototype._createRichMarker=function(e,t){var n,r;return this.serviceObject=new RichMarker({position:e,map:this.getMap(),draggable:t.marker_draggable,content:t.rich_marker,flat:((n=t.marker_anchor!=null)!=null?n:t.marker_anchor[1])?void 0:!1,anchor:((r=t.marker_anchor!=null)!=null?r:t.marker_anchor[0])?void 0:null,zIndex:t.zindex})},n.prototype._createMarker=function(e,t){var n,r,i,s,o,u;return r=this._createImageAnchorPosition(t.marker_anchor),o=this._createImageAnchorPosition(t.shadow_anchor),i=this._createOrRetrieveImage(t.marker_picture,t.marker_width,t.marker_height,r),u=this._createOrRetrieveImage(t.shadow_picture,t.shadow_width,t.shadow_height,o),n={position:e,map:this.getMap(),icon:i,title:t.marker_title,draggable:t.marker_draggable,shadow:u,zIndex:t.zindex},s=this.mergeObjects(this.controller.markers_conf.raw,n),this.serviceObject=new google.maps.Marker(s)},n.prototype._includeMarkerImage=function(e){var t,n,r,i,s;s=this.controller.markerImages;for(t=r=0,i=s.length;r<i;t=++r){n=s[t];if(n.url===e)return t}return!1},n.prototype._createOrRetrieveImage=function(e,t,n,r){var i,s;return typeof e=="undefined"||e===""||e===null?null:(s=this._includeMarkerImage(e))?typeof s=="number"?this.controller.markerImages[s]:!1:(i=this._createMarkerImage(e,this.createSize(t,n),null,r,null),this.controller.markerImages.push(i),i)},n.prototype._isBasicMarker=function(e){return e.marker_picture==null&&e.rich_marker==null},n.prototype._createMarkerImage=function(e,t,n,r,i){return new google.maps.MarkerImage(e,t,n,r,i)},n.prototype._createImageAnchorPosition=function(e){return e===null?null:this.createPoint(e[0],e[1])},n.prototype._openInfowindow=function(){var e;return e=this,function(){return e.controller._closeVisibleInfoWindow(),e.infowindow.open(e.getMap(),e.serviceObject),e.controller._setVisibleInfoWindow(e.infowindow)}},n}(Gmaps4Rails.Common)}).call(this);